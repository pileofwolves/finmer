{
	"!Type": "AssetScene",
	"AssetID": "0b23fd11-9316-4796-9eff-d4bba1205ba9",
	"AssetName": "Scene_TownInn",
	"ScriptCustom": {
		"!Type": "ScriptDataExternal",
		"Name": "Scene_TownInn_Custom"
	},
	"ScriptEnter": {
		"!Type": "ScriptDataExternal",
		"Name": "Scene_TownInn_Enter"
	},
	"IsGameStart": false,
	"IsPatchGroup": false,
	"Root": {
		"NodeType": "Root",
		"Children": [
			{
				"NodeType": "State",
				"Key": "Main",
				"ScriptAction": {
					"!Type": "ScriptDataInline",
					"Script": "SetInventoryEnabled(true)\r\n\r\n-- Saving tip when halfway through MQ01\r\nif not Storage.GetFlag(\"TIP_SAVE_AT_INN\") and Player:HasItem(\"I_MQ01_InnPass\") then\r\n    Storage.SetFlag(\"TIP_SAVE_AT_INN\", true)\r\n    Log(\"TIP_SAVE_AT_INN\", Color.Highlight)\r\nend"
				},
				"Children": [
					{
						"NodeType": "Choice",
						"Key": "Leave",
						"Title": "Leave",
						"Tooltip": "Bail!",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": {
							"!Type": "ScriptDataInline",
							"Script": "SetScene(\"Scene_TownMarket\")"
						},
						"Children": []
					},
					{
						"NodeType": "Choice",
						"Key": "Talk",
						"Title": "Talk",
						"Tooltip": "Exchange words with other living things.",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": {
							"!Type": "ScriptDataInline",
							"Script": "SetInventoryEnabled(false)"
						},
						"Children": [
							{
								"NodeType": "State",
								"Key": "InnTalkRoot",
								"ScriptAction": {
									"!Type": "ScriptDataInline",
									"Script": "SetInstruction(Text.GetString(\"town_inn_talktowho\"))"
								},
								"Children": [
									{
										"NodeType": "Choice",
										"Key": "TalkCancel",
										"Title": "< Back",
										"Tooltip": "Never mind... words are hard.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"Children": [
											{
												"NodeType": "Link",
												"LinkTarget": "Main"
											}
										]
									},
									{
										"NodeType": "Choice",
										"Key": "TalkInnkeep",
										"Title": "Barkeep",
										"Tooltip": "Talk to the fellow behind the bar.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": {
											"!Type": "ScriptDataInline",
											"Script": "-- Reset the bartender context for all following interactions in case it was removed\r\nText.SetContext(\"bartender\", barkeep)\r\n\r\n-- Greeting text\r\nlocal key = Storage.GetFlag(\"town_inn_barkeep_first\")\r\n    and \"TOWN_INN_BARKEEP_BEGIN\"\r\n    or \"TOWN_INN_BARKEEP_BEGIN_FIRST\"\r\nStorage.SetFlag(\"town_inn_barkeep_first\", true)\r\nLog(key)"
										},
										"Children": [
											{
												"NodeType": "State",
												"Key": "BarkeepTalkRoot",
												"Children": [
													{
														"NodeType": "Choice",
														"Title": "Leave",
														"Highlight": false,
														"ButtonWidth": 0.6,
														"ScriptAction": {
															"!Type": "ScriptDataInline",
															"Script": "Log(\"town_inn_barkeep_leave\")"
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "Main"
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "BarkeepTalkDrink",
														"Title": "Drink",
														"Tooltip": "Buy a drink and spend some time at the bar.",
														"Highlight": false,
														"ButtonWidth": 0.8,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "return Player.Money >= 1"
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "BottomsUp",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Player:ModifyMoney(-1)\r\nLog(\"town_inn_drink\")\r\nRumor.Present(barkeep)\r\nAdvanceTime(1)"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "Drink_C_Exit",
																		"Title": "Continue",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "Link",
																				"LinkTarget": "BarkeepTalkRoot"
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "BarkeepTalkInn",
														"Title": "Inn",
														"Tooltip": "Ask about how this inn came to be.",
														"Highlight": false,
														"ButtonWidth": 0.8,
														"ScriptAction": {
															"!Type": "ScriptDataVisualAction",
															"Nodes": [
																{
																	"!Type": "CommandVarSetFlag",
																	"VariableName": "TOWN_INN_BARKEEP_TALK_INN",
																	"OperandMode": "Literal",
																	"OperandLiteral": true
																},
																{
																	"!Type": "CommandLog",
																	"Text": "TOWN_INN_BARKEEP_TALK_INN",
																	"IsRaw": false
																}
															]
														},
														"ScriptAppear": {
															"!Type": "ScriptDataVisualCondition",
															"Mode": "All",
															"Operand": true,
															"Tests": [
																{
																	"!Type": "ConditionVarFlag",
																	"VariableName": "TOWN_INN_BARKEEP_TALK_INN",
																	"OperandMode": "Literal",
																	"OperandLiteral": false
																}
															]
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "BarkeepTalkRoot"
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "BarkeepTalkMQ01Start",
														"Title": "Work",
														"Tooltip": "Ask the barkeep if he knows any leads for work.",
														"Highlight": false,
														"ButtonWidth": 0.8,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "return not Storage.GetFlag(\"mq01_available\")"
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ01_R_Setup",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Text.SetContext(\"questgiver\", barkeep)\r\nLog(\"MQ01_SETUP1\")"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ01_C_Bridge",
																		"Title": "Bridge",
																		"Tooltip": "Ask how a trade route could just collapse like that.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ01_R_Bridge",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ01_SETUP_BRIDGE\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ01_C_Mayor"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ01_C_Exit"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ01_C_Mayor",
																		"Title": "Acting Mayor",
																		"Tooltip": "Ask what he meant by 'acting' mayor.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ01_R_Mayor",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ01_SETUP_MAYOR\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ01_C_Bridge"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ01_C_Exit"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ01_C_Exit",
																		"Title": "Continue",
																		"Tooltip": "Thank him for the information.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAction": {
																			"!Type": "ScriptDataInline",
																			"Script": "Log(\"MQ01_SETUP2\")\r\nStorage.SetFlag(\"mq01_available\", true)\r\nJournal.Update(\"MQ01\", 20)"
																		},
																		"Children": [
																			{
																				"NodeType": "Link",
																				"LinkTarget": "BarkeepTalkRoot"
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "BarkeepTalkMQ01",
														"Title": "Show Pass",
														"Tooltip": "Show the pass from the mayor.",
														"Highlight": true,
														"ButtonWidth": 0.8,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "return Player:HasItem(\"I_MQ01_InnPass\")"
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ01_R_GivePass",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"MQ01_BARKEEP1\")"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ01_C_GivePass2",
																		"Title": "Continue",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ01_R_GivePass2",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ01_BARKEEP2\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "MQ01_C_Messenger",
																						"Title": "Continue",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ01_R_Messenger",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Log(\"MQ01_BARKEEP3\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "MQ01_C_Complete1",
																										"Title": "Continue",
																										"Tooltip": "Thank him and take your leave.",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "MQ01_R_Complete1",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"MQ01_BARKEEP4\")\r\n\r\n-- Exchange pass for free room\r\nPlayer:TakeItem(\"I_MQ01_InnPass\")\r\nStorage.SetFlag(\"town_inn_rented_room\", true)\r\n\r\n-- Complete MQ01\r\nStorage.SetFlag(\"mq01_done\", true)\r\nPlayer:AwardXP(RewardXP.MQ01_Complete)\r\nJournal.Close(\"MQ01\")\r\nJournal.Update(\"MQ02\", 10)"
																												},
																												"Children": [
																													{
																														"NodeType": "Choice",
																														"Key": "MQ01_C_Complete2",
																														"Title": "Continue",
																														"Highlight": false,
																														"ButtonWidth": 1.0,
																														"Children": [
																															{
																																"NodeType": "Link",
																																"LinkTarget": "Main"
																															}
																														]
																													}
																												]
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "BarkeepTalkMQ02",
														"Title": "Bridge Supplies",
														"Tooltip": "Say you've got news.",
														"Highlight": true,
														"ButtonWidth": 0.8,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "return Storage.GetFlag(\"FOREST_COTTAGE_ENTRY_FIRST\") and not Storage.GetFlag(\"MQ02_DONE\")"
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02F_Begin",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"mq02_barkeep_begin\")"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02F_C_End",
																		"Title": "Finish",
																		"Tooltip": "That's all you know right now.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAppear": {
																			"!Type": "ScriptDataInline",
																			"Script": "return\r\n    Storage.GetFlag(\"mq02f_discuss_supplies\") and\r\n    Storage.GetFlag(\"mq02f_discuss_tiger\") and\r\n    Storage.GetFlag(\"mq02f_discuss_oliver\") and\r\n    Storage.GetFlag(\"mq02f_discuss_randall\")"
																		},
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02F_R_End",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_BARKEEP_END\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "MQ02F_C_End2",
																						"Title": "Continue",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ02F_R_End2",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Storage.SetFlag(\"MQ02_DONE\", true)\r\nLog(\"MQ02_BARKEEP_END2\")\r\nPlayer:AwardXP(RewardXP.MQ02_Complete)\r\nJournal.Close(\"MQ02\")\r\nJournal.Update(\"MQ03\", 20)"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "MQ02F_C_End3",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "Link",
																												"LinkTarget": "Main"
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02F_C_Supplies",
																		"Title": "Supplies",
																		"Tooltip": "Say where the supplies are.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAppear": {
																			"!Type": "ScriptDataInline",
																			"Script": "return not Storage.GetFlag(\"mq02f_discuss_supplies\")"
																		},
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02F_R_Supplies",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Storage.SetFlag(\"mq02f_discuss_supplies\", true)\r\nLog(\"mq02_barkeep_supplies\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_End"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Tiger"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Randall"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Oliver"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02F_C_Tiger",
																		"Title": "Messenger",
																		"Tooltip": "Explain what happened to the first messenger.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAppear": {
																			"!Type": "ScriptDataInline",
																			"Script": "return not Storage.GetFlag(\"mq02f_discuss_tiger\")"
																		},
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02F_R_Tiger",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Storage.SetFlag(\"mq02f_discuss_tiger\", true)\r\nLog(\"mq02_barkeep_tiger\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_End"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Supplies"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Randall"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Oliver"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02F_C_Oliver",
																		"Title": "Forester",
																		"Tooltip": "Explain what happened to Oliver.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAppear": {
																			"!Type": "ScriptDataInline",
																			"Script": "return not Storage.GetFlag(\"mq02f_discuss_oliver\")"
																		},
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02F_R_Oliver",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Storage.SetFlag(\"mq02f_discuss_oliver\", true)\r\n\r\n-- alternate keys for outcome of Oliver scene\r\nlocal key = \"MQ02_BARKEEP_OLIVER\"\r\nif Storage.GetFlag(\"oliver_eaten\") then\r\n    key = \"MQ02_BARKEEP_OLIVER_EATEN\"\r\nelseif Storage.GetFlag(\"oliver_dead\") then\r\n    key = \"MQ02_BARKEEP_OLIVER_DEAD\"\r\nend\r\nLog(key)"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_End"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Supplies"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Tiger"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Randall"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02F_C_Randall",
																		"Title": "Randall",
																		"Tooltip": "Talk about the cocky wolf you met.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAppear": {
																			"!Type": "ScriptDataInline",
																			"Script": "return not Storage.GetFlag(\"mq02f_discuss_randall\")"
																		},
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02F_R_Randall",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Storage.SetFlag(\"mq02f_discuss_randall\", true)\r\nLog(\"mq02_barkeep_randall\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_End"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Supplies"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Tiger"
																					},
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02F_C_Oliver"
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "BarkeepTalkRentRoom",
														"Title": "Rent a Room",
														"Tooltip": "Ask about a bed for the night.",
														"Highlight": false,
														"ButtonWidth": 0.8,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "-- Room is not yet made available, and also player is not about to get a free room\r\n-- (hide this option in the latter case because it's very confusing for the player)\r\nreturn not Storage.GetFlag(\"town_inn_rented_room\") and not Player:HasItem(\"I_MQ01_InnPass\")"
														},
														"Children": [
															{
																"NodeType": "State",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"TOWN_INN_RENT_DENIED\")"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Title": "Never mind",
																		"Tooltip": "Oh well...",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "Link",
																				"LinkTarget": "BarkeepTalkRoot"
																			}
																		]
																	}
																]
															}
														]
													}
												]
											}
										]
									},
									{
										"NodeType": "Choice",
										"Key": "TalkFoxtaur",
										"Title": "Taur",
										"Tooltip": "Talk to the big fuzzy-looking taur in the corner.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAppear": {
											"!Type": "ScriptDataInline",
											"Script": "return Storage.GetFlag(\"MQ03_DONE\") and not Storage.GetFlag(\"town_inn_foxtaur_arrested\")"
										},
										"Children": [
											{
												"NodeType": "State",
												"Key": "Foxtaur_R_DeclineReturn",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Log(\"INN_FOXTAUR_DECLINE_RETURN\")"
												},
												"ScriptAppear": {
													"!Type": "ScriptDataInline",
													"Script": "return Storage.GetFlag(\"INN_FOXTAUR_DECLINE\")"
												},
												"Children": [
													{
														"NodeType": "Link",
														"LinkTarget": "Foxtaur_C_GoUpstairs"
													},
													{
														"NodeType": "Link",
														"LinkTarget": "Foxtaur_C_GoDecline"
													}
												]
											},
											{
												"NodeType": "State",
												"Key": "Foxtaur_R_Approach",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Text.SetContext(\"partner\", foxtaur_partner)\r\nLog(\"INN_FOXTAUR_APPROACH\")\r\nPreySense(Creature(\"CR_Town_Foxtaur\"), EPreySenseType.OralVore, EPreySenseType.DigestionFatal)"
												},
												"Children": [
													{
														"NodeType": "Choice",
														"Key": "Foxtaur_C_Intro",
														"Title": "Introduce",
														"Tooltip": "Get their attention.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"Children": [
															{
																"NodeType": "State",
																"Key": "Foxtaur_R_IntroFox",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"INN_FOXTAUR_HELLO_FOX\")"
																},
																"ScriptAppear": {
																	"!Type": "ScriptDataInline",
																	"Script": "return Player.Species == \"fox\""
																},
																"Children": [
																	{
																		"NodeType": "Link",
																		"LinkTarget": "Foxtaur_C_AskDrink"
																	},
																	{
																		"NodeType": "Link",
																		"LinkTarget": "Foxtaur_C_AskChat"
																	}
																]
															},
															{
																"NodeType": "State",
																"Key": "Foxtaur_R_Intro",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"INN_FOXTAUR_HELLO\")"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "Foxtaur_C_AskDrink",
																		"Title": "Drink",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "Foxtaur_R_AskDrink",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"INN_FOXTAUR_ASK_DRINK\")\r\ntemp_getdrink = true"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "Foxtaur_C_DoJoin",
																						"Title": "Continue",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "Foxtaur_R_DoJoin",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Log(\"INN_FOXTAUR_JOIN1\")\r\n\r\nif temp_getdrink == true then\r\n    -- picked the 'drink' option earlier\r\n    Log(\"INN_FOXTAUR_JOIN_DRINK\")\r\nend\r\n\r\nLog(\"INN_FOXTAUR_JOIN2\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "Foxtaur_C_Apologize",
																										"Title": "Apologize",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "Foxtaur_R_Apologize",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"INN_FOXTAUR_JOIN_APOLOGIZE\")"
																												},
																												"Children": [
																													{
																														"NodeType": "Link",
																														"LinkTarget": "Foxtaur_C_WantChat"
																													},
																													{
																														"NodeType": "Link",
																														"LinkTarget": "Foxtaur_C_WantWork"
																													}
																												]
																											}
																										]
																									},
																									{
																										"NodeType": "Choice",
																										"Key": "Foxtaur_C_WantChat",
																										"Title": "Chat",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "Foxtaur_R_WantChat",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"INN_FOXTAUR_ASK_CHAT\")"
																												},
																												"Children": [
																													{
																														"NodeType": "Choice",
																														"Key": "Foxtaur_C_GoUpstairs",
																														"Title": "Join him",
																														"Tooltip": "A chat in private it is, then.",
																														"Highlight": false,
																														"ButtonWidth": 1.0,
																														"Children": [
																															{
																																"NodeType": "Link",
																																"LinkTarget": "Foxtaur_Private"
																															}
																														]
																													},
																													{
																														"NodeType": "Choice",
																														"Key": "Foxtaur_C_GoDecline",
																														"Title": "Decline",
																														"Tooltip": "Maybe not.",
																														"Highlight": false,
																														"ButtonWidth": 1.0,
																														"ScriptAction": {
																															"!Type": "ScriptDataInline",
																															"Script": "Log(\"INN_FOXTAUR_DECLINE\")\r\nStorage.SetFlag(\"INN_FOXTAUR_DECLINE\", true)"
																														},
																														"Children": [
																															{
																																"NodeType": "Link",
																																"LinkTarget": "Main"
																															}
																														]
																													}
																												]
																											}
																										]
																									},
																									{
																										"NodeType": "Choice",
																										"Key": "Foxtaur_C_WantWork",
																										"Title": "Work",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "Foxtaur_R_WantWork",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"INN_FOXTAUR_ASK_WORK\")\r\ntemp_foxtaurwork = true"
																												},
																												"Children": [
																													{
																														"NodeType": "Link",
																														"LinkTarget": "Foxtaur_C_GoUpstairs"
																													}
																												]
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "Foxtaur_C_AskChat",
																		"Title": "Chat",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "Foxtaur_R_AskChat",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"INN_FOXTAUR_ASK_TALK\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "Foxtaur_C_DoJoin"
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "Foxtaur_C_Leave",
														"Title": "Leave",
														"Tooltip": "Walk away.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "Main"
															}
														]
													}
												]
											}
										]
									},
									{
										"NodeType": "Choice",
										"Key": "TalkZoskMQ01",
										"Title": "Chameleon",
										"Tooltip": "Talk to the hooded fellow by the bar.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAppear": {
											"!Type": "ScriptDataInline",
											"Script": "return not Storage.GetFlag(\"MQ03_STARTED\") and not Storage.GetFlag(\"TOWN_INN_ZOSK_MET\")"
										},
										"Children": [
											{
												"NodeType": "State",
												"Key": "ZoskMQ01_R_First1",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Storage.SetFlag(\"TOWN_INN_ZOSK_MET\", true)\r\nLog(\"INN_ZOSK_GREET_FIRST1\")\r\nPlayer:AwardXP(RewardXP.OptionalSceneMinor)"
												},
												"Children": [
													{
														"NodeType": "Choice",
														"Key": "ZoskMQ01_C_First2",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": {
															"!Type": "ScriptDataInline",
															"Script": "Log(\"INN_ZOSK_GREET_FIRST2\")"
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "ZoskMQ01_R_Root"
															}
														]
													}
												]
											}
										]
									},
									{
										"NodeType": "Choice",
										"Key": "TalkZoskMQ01B",
										"Title": "Zosk",
										"Tooltip": "Talk to the friendly merchant again.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": {
											"!Type": "ScriptDataInline",
											"Script": "Log(\"INN_ZOSK_GREET\")"
										},
										"ScriptAppear": {
											"!Type": "ScriptDataInline",
											"Script": "return not Storage.GetFlag(\"MQ03_STARTED\") and Storage.GetFlag(\"TOWN_INN_ZOSK_MET\")"
										},
										"Children": [
											{
												"NodeType": "State",
												"Key": "ZoskMQ01_R_Root",
												"Children": [
													{
														"NodeType": "Choice",
														"Key": "ZoskMQ01_C_Leave",
														"Title": "Leave",
														"Tooltip": "Bid farewell.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": {
															"!Type": "ScriptDataInline",
															"Script": "Log(\"INN_ZOSK_LEAVE\")"
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "Main"
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "ZoskMQ01_C_Job",
														"Title": "Job",
														"Tooltip": "Ask Zosk about his work.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": {
															"!Type": "ScriptDataInline",
															"Script": "Storage.SetFlag(\"INN_ZOSK_TALK_JOB\", true)\r\nLog(\"INN_ZOSK_TALK_JOB\")"
														},
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "return not Storage.GetFlag(\"INN_ZOSK_TALK_JOB\")"
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "ZoskMQ01_R_Root"
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "ZoskMQ01_C_Bridge",
														"Title": "Bridge",
														"Tooltip": "Ask about what the work stoppage means for him.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": {
															"!Type": "ScriptDataInline",
															"Script": "Storage.SetFlag(\"INN_ZOSK_TALK_BRIDGE\", true)\r\nLog(\"INN_ZOSK_TALK_BRIDGE\")"
														},
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "return not Storage.GetFlag(\"INN_ZOSK_TALK_BRIDGE\")"
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "ZoskMQ01_R_Root"
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "ZoskMQ01_C_Repair",
														"Title": "Repairs!",
														"Tooltip": "Tell Zosk that repairs are finally about to start properly!",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": {
															"!Type": "ScriptDataInline",
															"Script": "Storage.SetFlag(\"INN_ZOSK_TALK_REPAIRS\", true)\r\nLog(\"INN_ZOSK_TALK_REPAIRS\")"
														},
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "-- Same conditions as completing MQ02 over at Edgard's dialogue tree\r\nreturn Storage.GetFlag(\"MQ02_AMBUSHED\") and not Storage.GetFlag(\"MQ02_DONE\")\r\n    and not Storage.GetFlag(\"INN_ZOSK_TALK_REPAIRS\")"
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "ZoskMQ01_R_Root"
															}
														]
													}
												]
											}
										]
									}
								]
							}
						]
					},
					{
						"NodeType": "Choice",
						"Key": "GoRoom",
						"Title": "Go Upstairs",
						"Tooltip": "Head up to your room.",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": {
							"!Type": "ScriptDataInline",
							"Script": "if Storage.GetFlag(\"TOWN_INN_ROOM_VISITED\") then\r\n    Log(\"TOWN_INN_ROOM_ENTER\")\r\nelse\r\n    Storage.SetFlag(\"TOWN_INN_ROOM_VISITED\", true)\r\n    Log(\"TOWN_INN_ROOM_ENTER_FIRST\")\r\n    Log(\"TOWN_INN_ROOM_ENTER_SAVE\", Color.Highlight)\r\nend"
						},
						"ScriptAppear": {
							"!Type": "ScriptDataInline",
							"Script": "return Storage.GetFlag(\"town_inn_rented_room\")"
						},
						"Children": [
							{
								"NodeType": "State",
								"Key": "Room_Main",
								"Children": [
									{
										"NodeType": "Choice",
										"Key": "Room_C_Leave",
										"Title": "Leave",
										"Tooltip": "Go back to the common room.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": {
											"!Type": "ScriptDataInline",
											"Script": "Log(\"town_inn_room_leave\")"
										},
										"Children": [
											{
												"NodeType": "Link",
												"LinkTarget": "Main"
											}
										]
									},
									{
										"NodeType": "Choice",
										"Key": "Room_C_Save",
										"Title": "Save",
										"Tooltip": "Record your adventure so far.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"Children": [
											{
												"NodeType": "State",
												"Key": "SavePoint_Room",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "SaveData.ShowSaveDialog()\r\n\r\n-- Welcome-back text when loading game\r\nif SaveData.IsRestoringGame() then\r\n    Log(\"TOWN_INN_SAVEPOINT_ENTER\")\r\nend"
												},
												"Children": [
													{
														"NodeType": "Link",
														"LinkTarget": "Room_C_Leave"
													},
													{
														"NodeType": "Link",
														"LinkTarget": "Room_C_Sleep"
													}
												]
											}
										]
									},
									{
										"NodeType": "Choice",
										"Key": "Room_C_Sleep",
										"Title": "Sleep until Morning",
										"Tooltip": "The bed does look rather inviting.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"Children": [
											{
												"NodeType": "State",
												"Key": "Room_R_SleepCannot",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Log(\"town_inn_room_nosleep\")"
												},
												"ScriptAppear": {
													"!Type": "ScriptDataInline",
													"Script": "return not Storage.GetFlag(\"TOWN_INN_CAN_SLEEP\")"
												},
												"Children": [
													{
														"NodeType": "Link",
														"LinkTarget": "Room_C_Leave"
													},
													{
														"NodeType": "Link",
														"LinkTarget": "Room_C_Save"
													},
													{
														"NodeType": "Link",
														"LinkTarget": "Room_C_Sleep"
													}
												]
											},
											{
												"NodeType": "State",
												"Key": "Room_R_Sleep",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Log(\"TOWN_INN_ROOM_SLEEP\")\r\nRest()"
												},
												"Children": [
													{
														"NodeType": "Choice",
														"Key": "RoomDoSleepEnd",
														"Title": "Continue",
														"Tooltip": "You wake up feeling refreshed...",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "Room_Main"
															}
														]
													}
												]
											}
										]
									},
									{
										"NodeType": "Choice",
										"Key": "Room_C_SleepNight",
										"Title": "Sleep until Night",
										"Tooltip": "The bed does look rather inviting.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAppear": {
											"!Type": "ScriptDataInline",
											"Script": "return not GetIsNight()"
										},
										"Children": [
											{
												"NodeType": "State",
												"Key": "Room_R_SleepNight",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Log(\"TOWN_INN_ROOM_SLEEP\")\r\nRestUntilNight()"
												},
												"Children": [
													{
														"NodeType": "Link",
														"LinkTarget": "RoomDoSleepEnd"
													}
												]
											}
										]
									}
								]
							}
						]
					}
				]
			},
			{
				"NodeType": "State",
				"Key": "Foxtaur_Private",
				"ScriptAction": {
					"!Type": "ScriptDataInline",
					"Script": "Log(\"INN_FOXTAUR_MOVE_AGREE\")\r\nLog(\"INN_FOXTAUR_MOVE1\")"
				},
				"Children": [
					{
						"NodeType": "Choice",
						"Key": "Foxtaur_C_Move1",
						"Title": "Continue",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"Children": [
							{
								"NodeType": "State",
								"Key": "Foxtaur_R_Move1",
								"ScriptAction": {
									"!Type": "ScriptDataInline",
									"Script": "Log(\"INN_FOXTAUR_MOVE2\")\r\n\r\nif Storage.GetFlag(\"TOWN_INN_ROOM_VISITED\") then\r\n    Log(\"INN_FOXTAUR_MOVE3\")\r\nelse\r\n    Log(\"INN_FOXTAUR_MOVE3_NOROOM\")\r\nend"
								},
								"Children": [
									{
										"NodeType": "Choice",
										"Key": "Foxtaur_C_Move2",
										"Title": "Step inside",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"Children": [
											{
												"NodeType": "State",
												"Key": "Foxtaur_R_Move2",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Log(\"INN_FOXTAUR_MOVE4\")\r\nLog((temp_foxtaurwork == true)\r\n    and \"INN_FOXTAUR_REVEAL_WORK\"\r\n    or \"INN_FOXTAUR_REVEAL_CHAT\")"
												},
												"Children": [
													{
														"NodeType": "Choice",
														"Key": "Foxtaur_C_Battle",
														"Title": "Uh-oh...",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": {
															"!Type": "ScriptDataInline",
															"Script": "local foxbutt = Creature(\"CR_Town_Foxtaur\")\r\nlocal state = Combat2()\r\nstate:AddParticipant(Player)\r\nstate:AddParticipant(foxbutt)\r\nstate:SetGrappling(foxbutt, Player)\r\nstate:Begin()"
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "Foxtaur_R_BattleWon",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "-- TODO: assuming player can't actually eat the taur due to size.\r\n-- so this doesn't handle vore scenarios at all.\r\n\r\nStorage.SetFlag(\"town_inn_foxtaur_arrested\", true)\r\nLog(\"INN_FOXTAUR_ARREST1\")"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "Foxtaur_C_Arrest",
																		"Title": "Continue",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "Foxtaur_R_Arrest",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"INN_FOXTAUR_ARREST2\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "Foxtaur_C_Arrest2",
																						"Title": "Leave",
																						"Tooltip": "Go back downstairs to the common room.",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "Foxtaur_R_Stmt1",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "LogSplit()\r\nLog(\"INN_FOXTAUR_STMT1\")\r\nLog(Storage.GetFlag(\"law_ever_arrested\") and \"INN_FOXTAUR_STMT2_MET\" or \"INN_FOXTAUR_STMT2_NEW\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "Foxtaur_C_Stmt_True",
																										"Title": "Truthful",
																										"Tooltip": "Try to relay the events as they happened.",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"ScriptAction": {
																											"!Type": "ScriptDataInline",
																											"Script": "Log(\"INN_FOXTAUR_STMT3_TRUE\")\r\nStorage.SetNumber(\"law_gavin_stmt\", 1)"
																										},
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "Foxtaur_R_StmtWrap1",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"INN_FOXTAUR_STMT_WRAPUP1\")\r\nStorage.SetFlag(\"law_gavin_arrested\", true)"
																												},
																												"Children": [
																													{
																														"NodeType": "Choice",
																														"Key": "Foxtaur_C_StmtWrap2",
																														"Title": "Continue",
																														"Highlight": false,
																														"ButtonWidth": 1.0,
																														"Children": [
																															{
																																"NodeType": "State",
																																"Key": "Foxtaur_R_StmtWrap2",
																																"ScriptAction": {
																																	"!Type": "ScriptDataInline",
																																	"Script": "Log(\"INN_FOXTAUR_STMT_WRAPUP2\")"
																																},
																																"Children": [
																																	{
																																		"NodeType": "Choice",
																																		"Key": "Foxtaur_C_StmtWrap3",
																																		"Title": "Continue",
																																		"Highlight": false,
																																		"ButtonWidth": 1.0,
																																		"Children": [
																																			{
																																				"NodeType": "State",
																																				"Key": "Foxtaur_R_StmtWrap3",
																																				"ScriptAction": {
																																					"!Type": "ScriptDataInline",
																																					"Script": "Log(\"INN_FOXTAUR_STMT_WRAPUP3\")\r\nPlayer:AwardXP(RewardXP.OptionalSceneMinor)"
																																				},
																																				"Children": [
																																					{
																																						"NodeType": "Link",
																																						"LinkTarget": "Leave"
																																					},
																																					{
																																						"NodeType": "Link",
																																						"LinkTarget": "Talk"
																																					},
																																					{
																																						"NodeType": "Link",
																																						"LinkTarget": "GoRoom"
																																					}
																																				]
																																			}
																																		]
																																	}
																																]
																															}
																														]
																													}
																												]
																											}
																										]
																									},
																									{
																										"NodeType": "Choice",
																										"Key": "Foxtaur_C_Stmt_Boast",
																										"Title": "Boast",
																										"Tooltip": "[Lie] Describe how you saved a lady's life.",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"ScriptAction": {
																											"!Type": "ScriptDataInline",
																											"Script": "Log(\"INN_FOXTAUR_STMT3_BOAST\")\r\nStorage.SetNumber(\"law_gavin_stmt\", 2)"
																										},
																										"Children": [
																											{
																												"NodeType": "Link",
																												"LinkTarget": "Foxtaur_R_StmtWrap1"
																											}
																										]
																									},
																									{
																										"NodeType": "Choice",
																										"Key": "Foxtaur_C_Stmt_Down",
																										"Title": "Downplay",
																										"Tooltip": "Try to alleviate the charge of predation against the taur.",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"ScriptAction": {
																											"!Type": "ScriptDataInline",
																											"Script": "Log(\"INN_FOXTAUR_STMT3_DOWNPLAY\")\r\nStorage.SetNumber(\"law_gavin_stmt\", 3)"
																										},
																										"Children": [
																											{
																												"NodeType": "Link",
																												"LinkTarget": "Foxtaur_R_StmtWrap1"
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "Foxtaur_C_DbgBatSkip",
														"Title": "[DBG] Skip Battle",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "return IsDevModeEnabled()"
														},
														"Children": [
															{
																"NodeType": "Link",
																"LinkTarget": "Foxtaur_R_BattleWon"
															}
														]
													}
												]
											}
										]
									}
								]
							}
						]
					}
				]
			}
		]
	}
}